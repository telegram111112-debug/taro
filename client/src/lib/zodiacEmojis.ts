// –≠–º–æ–¥–∑–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞–∫–∞ –∑–æ–¥–∏–∞–∫–∞
export const zodiacEmojis: Record<string, string> = {
  // –†—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è
  '–û–≤–µ–Ω': '‚ôà',
  '–¢–µ–ª–µ—Ü': '‚ôâ',
  '–ë–ª–∏–∑–Ω–µ—Ü—ã': '‚ôä',
  '–†–∞–∫': '‚ôã',
  '–õ–µ–≤': '‚ôå',
  '–î–µ–≤–∞': '‚ôç',
  '–í–µ—Å—ã': '‚ôé',
  '–°–∫–æ—Ä–ø–∏–æ–Ω': '‚ôè',
  '–°—Ç—Ä–µ–ª–µ—Ü': '‚ôê',
  '–ö–æ–∑–µ—Ä–æ–≥': '‚ôë',
  '–í–æ–¥–æ–ª–µ–π': '‚ôí',
  '–†—ã–±—ã': '‚ôì',
  // –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è (–Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è)
  'Aries': '‚ôà',
  'Taurus': '‚ôâ',
  'Gemini': '‚ôä',
  'Cancer': '‚ôã',
  'Leo': '‚ôå',
  'Virgo': '‚ôç',
  'Libra': '‚ôé',
  'Scorpio': '‚ôè',
  'Sagittarius': '‚ôê',
  'Capricorn': '‚ôë',
  'Aquarius': '‚ôí',
  'Pisces': '‚ôì',
}

// –ü–æ–ª—É—á–∏—Ç—å —ç–º–æ–¥–∑–∏ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∑–Ω–∞–∫–∞
export function getZodiacEmoji(zodiacSign: string | undefined): string {
  if (!zodiacSign) return '‚ú®'
  return zodiacEmojis[zodiacSign] || '‚ú®'
}

// –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∑–Ω–∞–∫–æ–≤ (–¥–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
export const zodiacInfo: Record<string, { element: string; emoji: string; elementEmoji: string }> = {
  '–û–≤–µ–Ω': { element: '–û–≥–æ–Ω—å', emoji: '‚ôà', elementEmoji: 'üî•' },
  '–¢–µ–ª–µ—Ü': { element: '–ó–µ–º–ª—è', emoji: '‚ôâ', elementEmoji: 'üåç' },
  '–ë–ª–∏–∑–Ω–µ—Ü—ã': { element: '–í–æ–∑–¥—É—Ö', emoji: '‚ôä', elementEmoji: 'üí®' },
  '–†–∞–∫': { element: '–í–æ–¥–∞', emoji: '‚ôã', elementEmoji: 'üíß' },
  '–õ–µ–≤': { element: '–û–≥–æ–Ω—å', emoji: '‚ôå', elementEmoji: 'üî•' },
  '–î–µ–≤–∞': { element: '–ó–µ–º–ª—è', emoji: '‚ôç', elementEmoji: 'üåç' },
  '–í–µ—Å—ã': { element: '–í–æ–∑–¥—É—Ö', emoji: '‚ôé', elementEmoji: 'üí®' },
  '–°–∫–æ—Ä–ø–∏–æ–Ω': { element: '–í–æ–¥–∞', emoji: '‚ôè', elementEmoji: 'üíß' },
  '–°—Ç—Ä–µ–ª–µ—Ü': { element: '–û–≥–æ–Ω—å', emoji: '‚ôê', elementEmoji: 'üî•' },
  '–ö–æ–∑–µ—Ä–æ–≥': { element: '–ó–µ–º–ª—è', emoji: '‚ôë', elementEmoji: 'üåç' },
  '–í–æ–¥–æ–ª–µ–π': { element: '–í–æ–∑–¥—É—Ö', emoji: '‚ôí', elementEmoji: 'üí®' },
  '–†—ã–±—ã': { element: '–í–æ–¥–∞', emoji: '‚ôì', elementEmoji: 'üíß' },
}

// –ê—Ä—Ö–µ—Ç–∏–ø—ã –∑–Ω–∞–∫–æ–≤ –∑–æ–¥–∏–∞–∫–∞ –¥–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏–π —Å–≤—è–∑–∏ —Å –∫–∞—Ä—Ç–∞–º–∏ –¢–∞—Ä–æ
const zodiacArchetypes: Record<string, { archetype: string; traits: string[]; energy: string }> = {
  '–û–≤–µ–Ω': {
    archetype: '–í–æ–∏–Ω',
    traits: ['—Å–º–µ–ª–æ—Å—Ç—å', '–∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞', '—Å—Ç—Ä–∞—Å—Ç—å', '–ª–∏–¥–µ—Ä—Å—Ç–≤–æ'],
    energy: '–æ–≥–Ω–µ–Ω–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –Ω–∞—á–∏–Ω–∞–Ω–∏–π'
  },
  '–¢–µ–ª–µ—Ü': {
    archetype: '–•—Ä–∞–Ω–∏—Ç–µ–ª—å',
    traits: ['—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å', '—Ç–µ—Ä–ø–µ–Ω–∏–µ', '—á—É–≤—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å', '–ø—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å'],
    energy: '–∑–µ–º–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –∏–∑–æ–±–∏–ª–∏—è'
  },
  '–ë–ª–∏–∑–Ω–µ—Ü—ã': {
    archetype: '–ü–æ—Å–ª–∞–Ω–Ω–∏–∫',
    traits: ['–æ–±—â–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å', '–æ—Å—Ç—Ä–æ—É–º–∏–µ'],
    energy: '–≤–æ–∑–¥—É—à–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –æ–±—â–µ–Ω–∏—è'
  },
  '–†–∞–∫': {
    archetype: '–ó–∞—â–∏—Ç–Ω–∏–∫',
    traits: ['—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å', '–∏–Ω—Ç—É–∏—Ü–∏—è', '–∑–∞–±–æ—Ç–∞', '–≥–ª—É–±–∏–Ω–∞'],
    energy: '–≤–æ–¥–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è —ç–º–æ—Ü–∏–π'
  },
  '–õ–µ–≤': {
    archetype: '–ü—Ä–∞–≤–∏—Ç–µ–ª—å',
    traits: ['—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ', '—Ö–∞—Ä–∏–∑–º–∞', '—â–µ–¥—Ä–æ—Å—Ç—å', '–≥–æ—Ä–¥–æ—Å—Ç—å'],
    energy: '—Å–æ–ª–Ω–µ—á–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è —Å–∞–º–æ–≤—ã—Ä–∞–∂–µ–Ω–∏—è'
  },
  '–î–µ–≤–∞': {
    archetype: '–¶–µ–ª–∏—Ç–µ–ª—å',
    traits: ['—Ç–æ—á–Ω–æ—Å—Ç—å', '—Å–ª—É–∂–µ–Ω–∏–µ', '–∞–Ω–∞–ª–∏–∑', '—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏–µ'],
    energy: '–∑–µ–º–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –æ—á–∏—â–µ–Ω–∏—è'
  },
  '–í–µ—Å—ã': {
    archetype: '–î–∏–ø–ª–æ–º–∞—Ç',
    traits: ['–≥–∞—Ä–º–æ–Ω–∏—è', '—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å', '–∫—Ä–∞—Å–æ—Ç–∞', '–ø–∞—Ä—Ç–Ω—ë—Ä—Å—Ç–≤–æ'],
    energy: '–≤–æ–∑–¥—É—à–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –±–∞–ª–∞–Ω—Å–∞'
  },
  '–°–∫–æ—Ä–ø–∏–æ–Ω': {
    archetype: '–ê–ª—Ö–∏–º–∏–∫',
    traits: ['—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è', '–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å', '–ø—Ä–æ–Ω–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–º–∞–≥–Ω–µ—Ç–∏–∑–º'],
    energy: '–≤–æ–¥–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –ø–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏—è'
  },
  '–°—Ç—Ä–µ–ª–µ—Ü': {
    archetype: '–ò—Å–∫–∞—Ç–µ–ª—å',
    traits: ['–æ–ø—Ç–∏–º–∏–∑–º', '—Ñ–∏–ª–æ—Å–æ—Ñ–∏—è', '—Å–≤–æ–±–æ–¥–∞', '–ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è'],
    energy: '–æ–≥–Ω–µ–Ω–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è'
  },
  '–ö–æ–∑–µ—Ä–æ–≥': {
    archetype: '–°—Ç—Ä–æ–∏—Ç–µ–ª—å',
    traits: ['–∞–º–±–∏—Ü–∏–æ–∑–Ω–æ—Å—Ç—å', '–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞', '–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å', '–¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è'],
    energy: '–∑–µ–º–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞'
  },
  '–í–æ–¥–æ–ª–µ–π': {
    archetype: '–ù–æ–≤–∞—Ç–æ—Ä',
    traits: ['–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å', '–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å', '–≥—É–º–∞–Ω–∏–∑–º', '–ø—Ä–æ–≥—Ä–µ—Å—Å'],
    energy: '–≤–æ–∑–¥—É—à–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è —Ä–µ–≤–æ–ª—é—Ü–∏–∏'
  },
  '–†—ã–±—ã': {
    archetype: '–ú–µ—á—Ç–∞—Ç–µ–ª—å',
    traits: ['—Å–æ—Å—Ç—Ä–∞–¥–∞–Ω–∏–µ', '–¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å', '—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ', '–∏–Ω—Ç—É–∏—Ü–∏—è'],
    energy: '–≤–æ–¥–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –µ–¥–∏–Ω—Å—Ç–≤–∞'
  },
}

// –ü–æ–ª—É—á–∏—Ç—å –ø—Å–µ–≤–¥–æ-—Å–ª—É—á–∞–π–Ω—ã–π –∏–Ω–¥–µ–∫—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞—Ç—ã
function getTodaySeed(): number {
  const today = new Date()
  return today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate()
}

function seededRandom(seed: number): number {
  const x = Math.sin(seed) * 10000
  return x - Math.floor(x)
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —Å–≤—è–∑–∏ –∫–∞—Ä—Ç—ã —Å–æ –∑–Ω–∞–∫–æ–º –∑–æ–¥–∏–∞–∫–∞
export function getZodiacCardExplanation(
  zodiacSign: string,
  cardName: string,
  cardElement?: string
): { title: string; explanation: string; dailyMessage: string } {
  const info = zodiacInfo[zodiacSign]
  const archetype = zodiacArchetypes[zodiacSign]

  if (!info || !archetype) {
    return {
      title: `${zodiacSign} –∏ ${cardName}`,
      explanation: '–≠—Ç–∞ –∫–∞—Ä—Ç–∞ –Ω–µ—Å—ë—Ç –æ—Å–æ–±–æ–µ –ø–æ—Å–ª–∞–Ω–∏–µ –¥–ª—è —Ç–≤–æ–µ–≥–æ –∑–Ω–∞–∫–∞.',
      dailyMessage: '–°–µ–≥–æ–¥–Ω—è —ç–Ω–µ—Ä–≥–∏—è —ç—Ç–æ–π –∫–∞—Ä—Ç—ã –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–∞ –¥–ª—è —Ç–µ–±—è.'
    }
  }

  const seed = getTodaySeed()
  const signIndex = Object.keys(zodiacInfo).indexOf(zodiacSign)

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
  const elementsMatch = cardElement && info.element === cardElement

  // –®–∞–±–ª–æ–Ω—ã –æ–±—ä—è—Å–Ω–µ–Ω–∏–π
  const explanationTemplates = [
    `–ö–∞—Ä—Ç–∞ ${cardName} —Ä–µ–∑–æ–Ω–∏—Ä—É–µ—Ç —Å —Ç–≤–æ–µ–π ${archetype.energy}. –ö–∞–∫ ${archetype.archetype}, —Ç—ã –æ—Å–æ–±–µ–Ω–Ω–æ —á—É–≤—Å—Ç–≤—É–µ—à—å –µ—ë –≤–ª–∏—è–Ω–∏–µ —á–µ—Ä–µ–∑ ${archetype.traits[0]} –∏ ${archetype.traits[1]}.`,
    `${zodiacSign} ${info.emoji} –æ–±–ª–∞–¥–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–π —Å–≤—è–∑—å—é —Å —ç—Ç–æ–π –∫–∞—Ä—Ç–æ–π. –¢–≤–æ–∏ –∫–∞—á–µ—Å—Ç–≤–∞ ‚Äî ${archetype.traits.slice(0, 2).join(' –∏ ')} ‚Äî –ø–æ–º–æ–≥–∞—é—Ç –≥–ª—É–±–∂–µ –ø–æ–Ω—è—Ç—å –µ—ë –ø–æ—Å–ª–∞–Ω–∏–µ.`,
    `–ê—Ä—Ö–µ—Ç–∏–ø ${archetype.archetype} –≤ —Ç–µ–±–µ –æ—Ç–∫–ª–∏–∫–∞–µ—Ç—Å—è –Ω–∞ —ç–Ω–µ—Ä–≥–∏—é –∫–∞—Ä—Ç—ã ${cardName}. –°–µ–≥–æ–¥–Ω—è –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω—ã —Ç–≤–æ–∏ ${archetype.traits[2]} –∏ ${archetype.traits[3]}.`,
  ]

  const dailyTemplates = [
    `–°–µ–≥–æ–¥–Ω—è ${archetype.energy} —É—Å–∏–ª–∏–≤–∞–µ—Ç –≤–ª–∏—è–Ω–∏–µ —ç—Ç–æ–π –∫–∞—Ä—Ç—ã –Ω–∞ —Ç–≤–æ—é –∂–∏–∑–Ω—å. –ò—Å–ø–æ–ª—å–∑—É–π —Å–≤–æ—é ${archetype.traits[Math.floor(seededRandom(seed + signIndex) * archetype.traits.length)]}, —á—Ç–æ–±—ã –≤–æ—Å–ø—Ä–∏–Ω—è—Ç—å –µ—ë –º—É–¥—Ä–æ—Å—Ç—å.`,
    `–í—Å–µ–ª–µ–Ω–Ω–∞—è –ø–æ—Å—ã–ª–∞–µ—Ç —Ç–µ–±–µ —ç—Ç—É –∫–∞—Ä—Ç—É –∏–º–µ–Ω–Ω–æ —Å–µ–π—á–∞—Å, –∫–æ–≥–¥–∞ —Ç–≤–æ—è ${archetype.traits[0]} –Ω–∞ –ø–∏–∫–µ. –ü—Ä–∏—Å–ª—É—à–∞–π—Å—è –∫ –µ—ë —Å–æ–≤–µ—Ç—É.`,
    `–ö–∞–∫ ${archetype.archetype}, —Å–µ–≥–æ–¥–Ω—è —Ç—ã –æ—Å–æ–±–µ–Ω–Ω–æ –≤–æ—Å–ø—Ä–∏–∏–º—á–∏–≤–∞ –∫ —ç–Ω–µ—Ä–≥–∏–∏ ${cardName}. –î–æ–≤–µ—Ä—å—Å—è —Å–≤–æ–µ–π –∏–Ω—Ç—É–∏—Ü–∏–∏.`,
  ]

  const explIndex = Math.floor(seededRandom(seed + signIndex * 7) * explanationTemplates.length)
  const dailyIndex = Math.floor(seededRandom(seed + signIndex * 13) * dailyTemplates.length)

  let explanation = explanationTemplates[explIndex]

  // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
  if (elementsMatch) {
    explanation += ` ${info.elementEmoji} –í–∞—à–∏ —Å—Ç–∏—Ö–∏–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç ‚Äî —ç—Ç–æ —É—Å–∏–ª–∏–≤–∞–µ—Ç —Å–≤—è–∑—å!`
  }

  return {
    title: `${info.emoji} ${zodiacSign} –∏ ${cardName}`,
    explanation,
    dailyMessage: dailyTemplates[dailyIndex]
  }
}
